var onlineBizPanel=function(e,a){function r(){n.toggleClass("ob-expanded ob-collapse"),t.toggleClass("ob-fadeOut ob-fadeIn"),o.find("i").toggleClass("rotate-up")}function c(e,a){var o=e?t:i;o.addClass("ob-hide"),o.toggleClass("ob-fadeOut ob-fadeIn"),a.removeClass("ob-hide"),a.outerHeight(),a.toggleClass("ob-fadeOut ob-fadeIn"),e||p.set(n[0])}function u(e,n){var t=a.createElement(e);return n&&Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])}),t}function f(e){r()}function b(a){c(!1,t),s.addClass("ob-hide"),e(".bottom-wrap, .top-wrap").remove()}function g(a){a.preventDefault();var n=e(this).attr("data-businessname"),t=ajaxManager.search("businessName",n),o=c.bind(null,!0,i);s.removeClass("ob-hide"),v(t,o)}function m(e){var a=e.target.scrollTop;a>=6&&d&&(o.addClass("drop-shadow"),d=!1),5>=a&&(o.removeClass("drop-shadow"),d=!0),p.update(a)}function h(e){p.save()}function v(n,t){var o,s=a.createDocumentFragment(),l=u("div",{"class":"top-wrap clearfix"}),d=u("div",{"class":"bottom-wrap"}),p=u("h2"),r=u("a",{"class":"ob-phone",href:"tel:"+n.phone}),c=u("a",{href:n.website,target:"_blank"}),f=u("p"),b=u("hr"),g=n.logo?u("img",{src:n.logo,alt:"business logo"}):void 0,m=n.mainimage?u("img",{src:n.mainimage,alt:"main image"}):void 0;g?e(l).append(g):g,e(l).append(p),e(l).append(r),e(p).append(n.businessName),e(r).append(n.phone),e(s).append(l),e(d).append(f),e(d).append(c),m?e(d).append(b,m):m,e(f).append(n.details),e(c).append(n.website),e(s).append(d),i.append(s),o=g?g:m,o?e(o).load(t):t()}function C(n){var o=a.createDocumentFragment();n.forEach(function(a){var n=u("li"),t=u("a",{"class":"ob-details",href:"#","data-businessname":a.businessName}),i=u("p"),s=u("div",{"class":"ob-phone"}),l=u("a",{href:a.website,target:"_blank"}),d=u("h2");e(n).append(t,s,l),e(d).append(a.businessName),e(i).append(a.details),e(t).append(d,i),e(s).append(a.phone),e(l).append(a.website),e(o).append(n)}),t.append(o)}function w(){n.hasClass("ob-expanded")&&r()}function k(){n.hasClass("ob-collapse")&&r()}function D(a){n=e(a.listContainer),t=e(a.listInnerContainer),o=e(a.toggleElement),i=e(a.fullDetails),s=e(a.backButton),ajaxManager.loadData(C),o.bind("click",f),t.on("click",'a[class^="ob-details"]',g),n.on("scroll",m),s.bind("click",b),t.on("mousedown",h.bind(p)),e("#loadbutton").bind("click",function(e){e.preventDefault(),ajaxManager.loadMore(5,C)})}var n,t,o,i,s,l,d=!0,p={top:[],temp:null,update:function(e){this.temp=e},save:function(){this.top.push(this.temp)},set:function(e){e.scrollTop=this.top[0],this.top.pop()}};return l={init:D,expand:k,collapse:w}}(jQuery,document);$(document).ready(function(){onlineBizPanel.init({listContainer:"#online-list-containter",listInnerContainer:"#online-list-containter ul",toggleElement:"#online-biz-toggle",fullDetails:"#ob-full-details",backButton:"#back-button"})});