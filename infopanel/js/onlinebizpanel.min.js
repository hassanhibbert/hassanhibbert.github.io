var onlineBizPanel=function(e,a){function d(){n.toggleClass("ob-expanded ob-collapse"),t.toggleClass("ob-fadeOut ob-fadeIn"),o.find("i").toggleClass("rotate-up")}function c(e){e.outerHeight()}function u(e,a){var o=e?t:s;o.addClass("ob-hide"),o.toggleClass("ob-fadeOut ob-fadeIn"),a.removeClass("ob-hide"),c(a),a.toggleClass("ob-fadeOut ob-fadeIn"),e||r.set(n[0])}function f(e){d()}function m(a){u(!1,t),i.addClass("ob-hide"),e(".bottom-wrap, .top-wrap").remove()}function h(a){a.preventDefault();var n=e(this).attr("data-businessname"),t=ajaxManager.search("businessName",n),o=u.bind(null,!0,s);i.removeClass("ob-hide"),C(t,o)}function b(e){var a=e.target,n=a.scrollTop,t=a.scrollHeight-a.clientHeight;n>=6&&p&&(o.addClass("drop-shadow"),p=!1),5>=n&&(o.removeClass("drop-shadow"),p=!0),r.update(n),n===t&&ajaxManager.loadMore(10,I)}function g(e){r.save()}function v(e,n){var t=a.createElement(e);return n&&Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])}),t}function C(n,t){var o,i=a.createDocumentFragment(),l=v("div",{"class":"top-wrap clearfix"}),p=v("div",{"class":"bottom-wrap"}),r=v("h2"),d=v("a",{"class":"ob-phone",href:"tel:"+n.phone}),c=v("a",{href:n.website,target:"_blank"}),u=v("p"),f=v("hr"),m=n.logo?v("img",{src:n.logo,alt:n.businessName}):void 0,h=n.mainimage?v("img",{src:n.mainimage,alt:n.businessName}):void 0;m?e(l).append(m):m,e(l).append(r),e(l).append(d),e(r).append(n.businessName),e(d).append(n.phone),e(i).append(l),e(p).append(u),e(p).append(c),h?e(p).append(f,h):h,e(u).append(n.details),e(c).append(n.website),e(i).append(p),s.append(i),o=m?m:h,o?e(o).load(t):t()}function y(e,a){return e.length>a?e.slice(0,a-3)+"...":e}function I(n){var o=a.createDocumentFragment();n.forEach(function(a){var n=v("li",{"class":"ob-fadeOut"}),t=v("a",{"class":"ob-details",href:"#","data-businessname":a.businessName}),s=v("p"),i=v("div",{"class":"ob-phone"}),l=v("a",{href:a.website,target:"_blank"}),p=v("h2"),r=y(a.details,73);e(n).append(t,i,l),e(p).append(a.businessName),e(s).append(r),e(t).append(p,s),e(i).append(a.phone),e(l).append(a.website),e(o).append(n)}),t.append(o),c(t),t.children("li").removeAttr("class")}function w(){n.hasClass("ob-expanded")&&d()}function x(){n.hasClass("ob-collapse")&&d()}function k(a){n=e(a.listContainer),t=e(a.listInnerContainer),o=e(a.toggleElement),s=e(a.fullDetails),i=e(a.backButton),ajaxManager.loadData(I),o.bind("click",f),t.on("click",'a[class^="ob-details"]',h),n.on("scroll",b),i.bind("click",m),t.on("mousedown",g.bind(r))}var n,t,o,s,i,l,p=!0,r={top:[],temp:null,update:function(e){this.temp=e},save:function(){this.top.push(this.temp)},set:function(e){e.scrollTop=this.top[0],this.top.pop()}};return l={init:k,expand:x,collapse:w,buildList:I}}(jQuery,document);$(document).ready(function(){onlineBizPanel.init({listContainer:"#online-list-containter",listInnerContainer:"#online-list-containter ul",toggleElement:"#online-biz-toggle",fullDetails:"#ob-full-details",backButton:"#back-button"}),$("#loadbutton").bind("click",function(e){e.preventDefault(),ajaxManager.loadMore(10,onlineBizPanel.buildList)})});